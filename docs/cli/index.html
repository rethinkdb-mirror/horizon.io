<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>The Horizon CLI</title>

        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/github.css">

        <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
        <link rel="shortcut icon" href="/favicon/favicon.ico">

        <!-- fonts.com -->
        <script type="text/javascript">
            // first, create the object that contains
            // configuration variables
            MTIConfig = {};

            // next, add a variable that will control
            // whether or not FOUT will be prevented
            MTIConfig.EnableCustomFOUTHandler = false // true = prevent FOUT
        </script>
        <script type="text/javascript" src="//fast.fonts.net/jsapi/5cf5064a-b80d-4123-82d3-5c7a863edb22.js"></script>
        <!-- jquery -->
        <script type="text/javascript" src="/js/jquery/jquery-2.2.3.min.js"></script>
        <!-- waypoints -->
        <script type="text/javascript" src="/js/waypoints/jquery.waypoints.min.js"></script>
        <script type="text/javascript" src="/js/waypoints/sticky.min.js"></script>
        <!-- horizon.io -->
        <script type="text/javascript" src="/js/site.js"></script>
    </head>
    <body>
        

        <nav class="site-nav">
            <div class="site-container">
                <a class="logo" href="/"><img src="/images/horizon-logo.png" alt="Horizon"></a>
                <ul class="navbar-links">
                    <li class="menu-trigger">
                        <svg height="24px" version="1.1" viewBox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><desc/><defs/><g fill="none" fill-rule="evenodd" id="miu" stroke="none" stroke-width="1"><g id="Artboard-1" transform="translate(-395.000000, -479.000000)"><g id="slice" transform="translate(215.000000, 119.000000)"/><path d="M396.500836,485 C396.224232,485 396,485.214035 396,485.504684 L396,486.495316 C396,486.774045 396.217742,487 396.500836,487 L417.499164,487 C417.775768,487 418,486.785965 418,486.495316 L418,485.504684 C418,485.225955 417.782258,485 417.499164,485 L396.500836,485 Z M396.500836,490 C396.224232,490 396,490.214035 396,490.504684 L396,491.495316 C396,491.774045 396.217742,492 396.500836,492 L417.499164,492 C417.775768,492 418,491.785965 418,491.495316 L418,490.504684 C418,490.225955 417.782258,490 417.499164,490 L396.500836,490 Z M396.500836,495 C396.224232,495 396,495.214035 396,495.504684 L396,496.495316 C396,496.774045 396.217742,497 396.500836,497 L417.499164,497 C417.775768,497 418,496.785965 418,496.495316 L418,495.504684 C418,495.225955 417.782258,495 417.499164,495 L396.500836,495 Z" id="editor-list-view-hambuger-menu-glyph"/></g></g></svg>

                    </li>
                    <li>
                        <a href="/cloud">Horizon Cloud</a>
                    </li>
                    <li>
                        <a href="/install">Install</a>
                    </li>
                    <li>
                        <a href="/faq">FAQ</a>
                    </li>
                    <li class="active">
                        <a href="/docs">Docs</a>
                    </li>
                    <li>
                        <a href="/community">Community</a>
                    </li>
                    <li>
                        <a href="/blog">Blog</a>
                    </li>
                </ul>
            </div>
        </nav>
        <section class="site-content">
            <section class="documentation">
    <div class="site-container">
        <nav class="docs-nav">
            
            <section>
                <h1>Horizon basics</h1>
                <ul>
                    
                        <li>
                            <!-- index | cli -->
                            <a href="/docs">Overview</a>
                        </li>
                    
                        <li>
                            <!-- install | cli -->
                            <a href="/install">Install Horizon</a>
                        </li>
                    
                        <li>
                            <!-- faq | cli -->
                            <a href="/faq">FAQ</a>
                        </li>
                    
                        <li>
                            <!-- getting-started | cli -->
                            <a href="/docs/getting-started">Getting started</a>
                        </li>
                    
                </ul>
            </section>
            
            <section>
                <h1>Building Horizon apps</h1>
                <ul>
                    
                        <li class="active">
                            <!-- cli | cli -->
                            <a href="/docs/cli">Horizon CLI</a>
                        </li>
                    
                        <li>
                            <!-- auth | cli -->
                            <a href="/docs/auth">Authentication</a>
                        </li>
                    
                        <li>
                            <!-- users | cli -->
                            <a href="/docs/users">Users and groups</a>
                        </li>
                    
                        <li>
                            <!-- permissions | cli -->
                            <a href="/docs/permissions">Permissions</a>
                        </li>
                    
                        <li>
                            <!-- api-collection | cli -->
                            <a href="/api/collection">Collection API</a>
                        </li>
                    
                        <li>
                            <!-- api-horizon | cli -->
                            <a href="/api/horizon">Horizon API</a>
                        </li>
                    
                </ul>
            </section>
            
            <section>
                <h1>Resources</h1>
                <ul>
                    
                        <li>
                            <!-- config | cli -->
                            <a href="/docs/configuration">Configuring Horizon</a>
                        </li>
                    
                        <li>
                            <!-- embed | cli -->
                            <a href="/docs/embed">Embedding Horizon</a>
                        </li>
                    
                        <li>
                            <!-- examples | cli -->
                            <a href="/docs/examples">Example apps</a>
                        </li>
                    
                        <li>
                            <!-- limitations | cli -->
                            <a href="/docs/limitations">Limitations</a>
                        </li>
                    
                        <li>
                            <!-- docker | cli -->
                            <a href="/docs/docker">Horizon with Docker</a>
                        </li>
                    
                </ul>
            </section>
            
        </nav>
        <section class="docs-article document">
            
            <h1 class="title">The Horizon CLI</h1>
            <p>The <code class="highlighter-rouge">hz</code> command line tool’s primary function is to start a standalone Horizon server. It also provides utilities for initializing a new Horizon project, creating a self-signed SSL certificate, and other tasks.</p>

<p><strong>Commands</strong></p>

<ul id="markdown-toc">
  <li><a href="#init" id="markdown-toc-init">init</a></li>
  <li><a href="#serve" id="markdown-toc-serve">serve</a>    <ul>
      <li><a href="#serve-options" id="markdown-toc-serve-options">Command-line options</a></li>
      <li><a href="#development-mode" id="markdown-toc-development-mode">Development mode</a></li>
    </ul>
  </li>
  <li><a href="#create-cert" id="markdown-toc-create-cert">create-cert</a></li>
  <li><a href="#schema-save" id="markdown-toc-schema-save">schema save</a></li>
  <li><a href="#schema-apply" id="markdown-toc-schema-apply">schema apply</a></li>
  <li><a href="#migrate" id="markdown-toc-migrate">migrate</a></li>
  <li><a href="#make-token" id="markdown-toc-make-token">make-token</a></li>
</ul>

<h1 id="init">init</h1>

<p>Initialize a new Horizon project. <code class="highlighter-rouge">hz init</code> with no argument will initialize a project in the current directory; <code class="highlighter-rouge">hz init &lt;directory&gt;</code> will initialize a project in the specified directory, creating the directory if necessary. The project will be given the name of the specified directory (the current directory if no argument is given).</p>

<h1 id="serve">serve</h1>

<p>The <code class="highlighter-rouge">hz serve &lt;project path&gt;</code> command starts a Horizon server for the given Horizon project. Once started, it serves HTTP(S) requests for your application on the configured port.</p>

<p>Every Horizon server requires a RethinkDB server to connect to. Use the <code class="highlighter-rouge">--connect &lt;RethinkDB host&gt;</code> option to connect to an existing RethinkDB server, or use <code class="highlighter-rouge">--start-rethinkdb</code> to automatically start a local RethinkDB server. (Note that the <code class="highlighter-rouge">--dev</code> option for development mode includes <code class="highlighter-rouge">--start-rethinkdb</code> by default.)</p>

<p>Note that if you are using a database from a Horizon 1.x application, the <code class="highlighter-rouge">serve</code> command will exit with an error. Use [hz migrate]{#migrate} to upgrade your database in place.</p>

<h2 id="serve-options">Command-line options</h2>

<p><code class="highlighter-rouge">hz serve</code> supports the following command-line options:</p>

<h3 id="general-options">General options</h3>

<ul>
  <li><code class="highlighter-rouge">--project-name NAME, -n NAME</code> Name of the Horizon project. Determines the name of the RethinkDB database that stores the project data.</li>
  <li><code class="highlighter-rouge">--serve-static [PATH]</code> Enable serving static files via HTTP(S). You can additionally specify the path from which static files will be served (default: <code class="highlighter-rouge">./dist</code>).</li>
  <li><code class="highlighter-rouge">--debug [yes|no]</code> Print additional debug output. Default: <code class="highlighter-rouge">no</code></li>
  <li><code class="highlighter-rouge">--schema-file [PATH]</code> Use a given schema file for the database. If the specified schema conflicts with the existing database, a warning will be printed to the console and the option will be ignored. (Use <code class="highlighter-rouge">hz schema apply --force</code> to override this.)</li>
</ul>

<h3 id="network-options">Network options</h3>

<ul>
  <li><code class="highlighter-rouge">--bind HOST, -b HOST</code> The host name or IP address that the Horizon server should listen on for incoming requests. Can be specified multiple times to bind to multiple addresses. Default: <code class="highlighter-rouge">localhost</code></li>
  <li><code class="highlighter-rouge">--port PORT, -p PORT</code> The port number the Horizon server should listen on for incoming requests. Default: <code class="highlighter-rouge">8181</code></li>
  <li><code class="highlighter-rouge">--connect HOST:PORT, -c HOST:PORT</code> The host and port of the RethinkDB server to connect to, or a <code class="highlighter-rouge">rethinkdb://</code> URI string (see <a href="/docs/configuration/#rdbopts">RethinkDB options</a> in the configuration file documentation for details). Default: <code class="highlighter-rouge">localhost:28015</code></li>
  <li><code class="highlighter-rouge">--key-file PATH</code> The key file to use for the HTTPS server. Default: <code class="highlighter-rouge">./horizon-key.pem</code></li>
  <li><code class="highlighter-rouge">--cert-file PATH</code> The certificate to use for the HTTPS server. Default: <code class="highlighter-rouge">./horizon-cert.pem</code></li>
  <li><code class="highlighter-rouge">--rdb_timeout SECONDS</code>: timeout to make the connection to the RethinkDB cluster, in seconds. Default: 20</li>
</ul>

<p>The following options provide alternatives to specifying these values in the <code class="highlighter-rouge">--connect</code> string:</p>

<ul>
  <li><code class="highlighter-rouge">--rdb_host HOSTNAME</code></li>
  <li><code class="highlighter-rouge">--rdb_port PORT</code></li>
  <li><code class="highlighter-rouge">--rdb_user USERNAME</code></li>
  <li><code class="highlighter-rouge">--rdb_password PASSWORD</code></li>
</ul>

<h3 id="authentication-options">Authentication options</h3>

<ul>
  <li><code class="highlighter-rouge">--token-secret SECRET</code> A key string for signing JWTs. If not specified, a new random secret is used on each server start.</li>
  <li><code class="highlighter-rouge">--allow-unauthenticated [yes|no]</code> Allow unauthenticated users. See <a href="/docs/auth">Authentication</a> for details. Default: <code class="highlighter-rouge">no</code></li>
  <li><code class="highlighter-rouge">--allow-anonymous [yes|no]</code> Allow anonymous users. See <a href="/docs/auth">Authentication</a> for details. Default: <code class="highlighter-rouge">no</code></li>
  <li><code class="highlighter-rouge">--auth PROVIDER,ID,SECRET</code> Enable an auth provider with the given options. E.g. <code class="highlighter-rouge">facebook,ID,SECRET</code>. See <a href="/docs/auth">Authentication</a> for details.</li>
  <li><code class="highlighter-rouge">--auth-redirect URL</code> The URL to redirect to upon completing authentication. Default: <code class="highlighter-rouge">/</code></li>
  <li><code class="highlighter-rouge">--access-control-allow-origin</code>: A host that can access auth settings in production (i.e., set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Origin">Access-Control-Allow-Origin HTTP header</a>). <code class="highlighter-rouge">"*"</code> may be specified as a wildcard. Default: <code class="highlighter-rouge">''</code></li>
</ul>

<h3 id="development-options">Development options</h3>

<ul>
  <li><code class="highlighter-rouge">--dev</code> Runs the server in <a href="#development-mode">development mode</a>.</li>
  <li><code class="highlighter-rouge">--secure [yes|no]</code> Serve websockets and files over encrypted (HTTPS) connections. Ignores the <code class="highlighter-rouge">--key-file</code> and <code class="highlighter-rouge">--cert-file</code> options if set to <code class="highlighter-rouge">no</code>. Default: <code class="highlighter-rouge">yes</code></li>
  <li><code class="highlighter-rouge">--permissions [yes|no]</code> Check <a href="/docs/permissions">permissions</a> on requests. Warning: Disabling this on a production server is a security risk and can be used by an attacker to exhaust the server’s resources. Only recommended for development use. Default: <code class="highlighter-rouge">yes</code></li>
  <li><code class="highlighter-rouge">--start-rethinkdb [yes|no]</code> Start up a RethinkDB in the current directory. Ignores <code class="highlighter-rouge">--connect</code> if enabled. Default: <code class="highlighter-rouge">no</code></li>
  <li><code class="highlighter-rouge">--auto-create-collection [yes|no]</code> Create collections automatically on first use. Warning: Enabling this on a production server is a security risk and can be used by an attacker to exhaust the server’s resources. Only recommended for development use. Default: <code class="highlighter-rouge">no</code></li>
  <li><code class="highlighter-rouge">--auto-create-index [yes|no]</code> Create indexes automatically on first use. Warning: Enabling this on a production server is a security risk and can be used by an attacker to exhaust the server’s resources. Only recommended for development use.  Default: <code class="highlighter-rouge">no</code></li>
</ul>

<h2 id="development-mode">Development mode</h2>

<p>In development mode (<code class="highlighter-rouge">hz serve --dev</code>), the following flags are enabled by default:</p>

<ul>
  <li><code class="highlighter-rouge">--secure no</code></li>
  <li><code class="highlighter-rouge">--permissions no</code></li>
  <li><code class="highlighter-rouge">--auto-create-collection yes</code></li>
  <li><code class="highlighter-rouge">--auto-create-index yes</code></li>
  <li><code class="highlighter-rouge">--start-rethinkdb yes</code></li>
  <li><code class="highlighter-rouge">--allow-unauthenticated yes</code></li>
  <li><code class="highlighter-rouge">--allow-anonymous yes</code></li>
  <li><code class="highlighter-rouge">--serve-static ./dist</code></li>
  <li><code class="highlighter-rouge">--access-control-allow-origin '*'</code></li>
  <li><code class="highlighter-rouge">--schema-file .hz/schema.toml</code></li>
</ul>

<p>Development mode makes it easy to run a local Horizon instance during application development. Because permission checking is disabled and collections and indexes get automatically created, new application code can be tested without additional configuration.</p>

<p>Development mode should never be enabled on a production server that is publicly accessible. An attacker can exploit a development server by sending unintended requests. These requests can be used to read and/or modify arbitrary data stored for your Horizon application, or can be used to exhaust the resources of your server.</p>

<h1 id="create-cert">create-cert</h1>

<p>Create a private and public TLS certificate pair for development. Running this will create two files, <code class="highlighter-rouge">horizon-cert.pem</code> and <code class="highlighter-rouge">horizon-key.pem</code>. These can be specified as options to <code class="highlighter-rouge">hz serve</code> or placed in the <a href="/docs/configuration">configuration file</a>.</p>

<p>Note that the certificate created by <code class="highlighter-rouge">create-cert</code> uses no local identity information; the data is completely random. If you need to use an existing certificate or credentials, you’ll have to create the certificate on your own using <code class="highlighter-rouge">openssl</code> or a similar tool.</p>

<h1 id="schema-save">schema save</h1>

<p>Save the currently defined Horizon schema, including validation rules, collection and index specifications, as a TOML file. For an example of this command in practice, read the section on “Configuring rules” in <a href="/docs/permissions/#configuring">Permissions and schema enforcement</a>.</p>

<p>Run <code class="highlighter-rouge">hz schema save -h</code> for details on options.</p>

<p>If you use the default schema filename (<code class="highlighter-rouge">.hz/schema.toml</code>), existing schema files will be preserved, renamed to <code class="highlighter-rouge">schema.toml_</code> with a datestamp appended.</p>

<h1 id="schema-apply">schema apply</h1>

<p>Load a previously-extracted schema into a Horizon cluster. Run <code class="highlighter-rouge">hz schema apply -h</code> for details on options.</p>

<p>While the schema format changed with Horizon 2.0, <code class="highlighter-rouge">schema apply</code> will read pre-2.0 files. (Use <code class="highlighter-rouge">schema save</code> to rewrite them in the current format.)</p>

<h1 id="migrate">migrate</h1>

<p>Migrate a Horizon database from the 1.x to 2.x internal format. This command must be used on databases created with Horizon 1.x applications; Horizon will exit with an error if the <code class="highlighter-rouge">serve</code> command is executed with an old format database.</p>

<h1 id="make-token">make-token</h1>

<p>Manually create a JSON Web Token for a user, allowing user bootstrapping. This is necessary to log in as the Horizon admin user the first time. Simply pass the user ID value to <code class="highlighter-rouge">make-token</code> as the argument:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>hz make-token [user-id]
</code></pre>
</div>

<p>The JWT will be printed to the console.</p>

<p>For more details, read “Making an admin auth token” in <a href="/docs/permissions/#admin">Permissions and schema enforcement</a>.</p>


        </section>
    </div>
</section>

        </section>
        <footer>
            <div class="site-container">
                <section class="about">
                    <h1 class="hz">Horizon is a <strong>realtime, open-source backend</strong> for JavaScript apps.</h1>
                    <a href="https://github.com/rethinkdb/horizon" class="button primary-button">Star the project on GitHub</a>
                </section>
                <section class="footer-right">
                    <nav class="site-map">
                        <section>
                            <h1>Getting started</h1>
                            <ul>
                                <li><a href="/faq">FAQ</a></li>
                                <li><a href="/install">Install</a></li>
                                <li><a href="/docs/getting-started">Getting started</a></li>
                            </ul>
                        </section>
                        <section>
                            <h1>Documentation</h1>
                            <ul>
                                <li><a href="/api/collection">Collection API</li>
                                <li><a href="/api/horizon">Horizon API</a></li>
                                <li><a href="/docs/cli">Horizon CLI</a></li>
                            </ul>
                        </section>
                        <section>
                            <h1>Get involved</h1>
                            <ul>
                                <li><a href="http://slack.rethinkdb.com">Join us on Slack #horizon</a></li>
                                <li><a href="https://discuss.horizon.io">Discuss on Discourse</a></li>
                                <li><a href="https://rethinkdb.com/community/shirts-for-stories/">Shirts for Stories</a></li>
                            </ul>
                        </section>
                    </nav>
                    <h1 class="github">Built by the <a href="https://rethinkdb.com">RethinkDB team</a> and an amazing community.</h2>
                </section>
            </div>
        </footer>
        <script type="text/javascript">
          var _gauges = _gauges || [];
          (function() {
            var t   = document.createElement('script');
            t.type  = 'text/javascript';
            t.async = true;
            t.id    = 'gauges-tracker';
            t.setAttribute('data-site-id', '56fb1a594b2ffa61f100a699');
            t.setAttribute('data-track-path', 'https://track.gaug.es/track.gif');
            t.src = 'https://d36ee2fcip1434.cloudfront.net/track.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(t, s);
          })();
        </script>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-9922584-3', 'auto');
          ga('send', 'pageview');

      </script>
    </body>
</html>
